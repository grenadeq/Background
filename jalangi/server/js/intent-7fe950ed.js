"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("data/intent",["jquery","log","common/util","widget/dialog/success","data/wechat-entry","jquery.cookie","jquery.fullscreen"],function(e,t,i){var n=void 0,o=void 0,a=void 0,r=["appointment","consult","discount_notify","time_limit_appointment"],c=["buyer","bargain","lxb","appointment_edit"].concat(r,r.map(function(e){return e+"_extra"})),s=function(e){return r.indexOf(e)!==-1},u=function(e){return c.indexOf(e)!==-1},d=function(r,c,s){n=c;var d={dataType:"json",type:"POST",url:"/index.php?d=api&c=intent&m=",timeout:3e4,error:function(){t.push(["_trackEvent","pc_intent_"+a+"_timeout","click","timeout"])},success:function(c,s,d,f){var m=c,p=e("#js-verification-modal-markup");p.length&&(e("body").append(p.html()),p.remove());var v=e("#js-verification-modal"),g=e("#js-verification-img"),_=e("#js-verification-code"),b=e("#js-verification-error"),y=e("#js-verification-submit");if(v.find(".js-delayed-img").each(function(){var t=e(this);t.attr("src",t.attr("data-src")).removeClass("js-delayed-img")}),y.off("click"),y.on("click",function(){return""===_.val()?(b.show(),void _.focus()):(b.hide(),y.attr("disabled",!0),o.data.verify_code=_.val(),o.data.isRefresh="",void e.ajax(o))}),m&&"undefined"!=typeof m.status){var h=parseInt(m.status,10),R=m.status_v2?parseInt(m.status_v2,10):0;if(m.image&&(m.image=m.image.replace(/^http:/,"")),y.attr("disabled",!1),400===h){var j=429===R?"验证码输入失败次数过多，请等待":"验证码不正确";return n(m),_.val(""),g.attr("src",m.image),v.fullscreen({backdrop:"static",show:!0}),v.find(".dialog-title").html("请输入验证码"),_.focus(),m.forced_message&&b.html(j).show(),void t.push(["_trackEvent","m_verification_show","click","verification"])}var k=i.parseQueryString(f);if("none"!==v.css("display")&&v.fullscreen("hide"),!m.display_next_page||!l.c2add(k,m)){if(!e.cookie("rrc_login_phone")&&u(a)){var C=function(){"bargain"===a&&e("#bargain_modal").fullscreen("hide");var t=void 0;return t="bargain"===a||"lxb"===a||"appointment_edit"===a?r.phone:r.mobile_number,require(["react","react-dom","components/login"],function(e,i,o){var r=document.getElementById("login");if(r){var c=i.render(e.createElement(o.Login,{onCallback:function(){n(m)},RRC:RRC}),r);c.setState({title:"请输入短信验证码",desc:"",phone:t,disablePhone:!0,icon:"//img1.rrcimg.com/dist/pc/images/icon-code-30ec0fe8.png",buttonText:"提交",modalCls:"login-modal-"+a,isLoginShow:!0,showRules:!1},function(){c.getVerifyCode()})}}),{v:void 0}}();if("object"===("undefined"==typeof C?"undefined":_typeof(C)))return C.v}0===h&&t.push(["_trackEvent",k.submit_sources+"-提交成功","click",""]),n(m)}}},data:r};return d};e("body").on("click","#js-verification-modal .close-btn",function(){e(this).parents("#js-verification-modal").fullscreen("hide"),e("#js-verification-error").html("").hide()}),e("body").on("click","#js-verification-refresh",function(){o.data.isRefresh="true",e.ajax(o)});var l=function(i,n,r,c){var u=n;a=i;var l=r||function(){};s(a)&&(u.city=RRC.cityName),o=d(u,l,c),o.url+=i,e.ajax(o),RRC.pageLoadTime&&(t.push(["_trackEvent","intent_first_submit_time",{time:(new Date).getTime()-RRC.pageLoadTime,intent:i,submit_sources:u.submit_sources,platform:"PC",pageName:RRC.pageName}]),RRC.pageLoadTime=null)};return l.c2add=function(t,i){var n={bargain:"砍价成功立即帮您约车",discount_notify:"降价后立即帮您约车",time_limit_appointment:"约车速度更快",appointment:"约车速度更快",consult:"车况合适立即帮您约车"},o=!!e("#sold_button").length;return"undefined"!=typeof n[a]&&RRC.pageName.indexOf("car-detail")>-1&&!o&&(require(["page/detail/c2-add"],function(e){var o=void 0;o="bargain"===a?t.phone:t.mobile_number;var r={title:n[a],phone:o,userPrice:t.price,salePrice:RRC.carPrice,submit_sources:t.submit_sources,sub_product:a,profile:i.profile};e.init(r)}),!0)},l.getMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return e.getHours()<8||e.getHours()>21?"人人车小伙伴下班了，上班后会尽快联系您，请注意接听来电":"人人车客服将尽快联系您，请保持手机畅通"},l.isAppointmentAction=s,l.isC2Action=u,l.optionFun=d,l});
//# sourceMappingURL=intent-7fe950ed.js.map
