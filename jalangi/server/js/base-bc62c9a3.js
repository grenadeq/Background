"use strict";define("page/search/base",["data/wechat-entry","common/util"],function(e,t){function i(){var e={},t=["mileage","displacement","emission","age","car_color","star_config","special_tags"];return $(".subscription-list .filter-selected").each(function(i,r){var n=$(r).attr("subscribe-key");t.indexOf(n)>-1?e[n]?e[n]+=","+$(r).attr("subscribe-value"):e[n]=$(r).attr("subscribe-value"):e[$(r).attr("subscribe-key")]=$(r).attr("subscribe-value")}),e}function r(){$("#search_list_wrapper .schedule").on("click",function(i){var r=this;i.stopPropagation(),i.preventDefault(),e.replaceAppointment("2643"),require(["jquery","common/appoint"],function(e,i){i.init({car_id:e(r).data("id")},{title:"请输入你的手机号",successMessage:t.getPCIntentSuccessTips("yuyue"),carTitle:e(r).data("title")},"consult"),i.show()})})}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return $.ajax({url:"/api/user/subscription/add",method:"post",dataType:"json",data:{token:$.cookie("rrc_login_token"),record_data:JSON.stringify(e),ep:JSON.stringify({fr:RRC.fr,page:"列表页",city:RRC.city})}}).done(function(t){if(0===parseInt(t.status,10)){var i=$("#js-success-modal-common");i.find("#js-confirm-title").html("订阅成功"),i.find("#js-confirm-message").html("符合此条件车辆上架时，我们将会短信通知您。</br>您也可以下载APP查询所有历史订阅车辆。"),i.find(".c1").hide(),i.find(".c2").show(),i.fullscreen("show"),require(["log"],function(t){t.push(["_trackEvent","订阅条件","click",{condition:e}])})}})}function a(){require(["page/search/filter","common/app"],function(e,t){var i=new t(window.RRC);e.init(),$(document).on("click",".js-pagination a",function(t){if(!$(this).hasClass("disabled")&&!$(this).hasClass("active")){t.preventDefault();var r=$(this).attr("href");r=r.split("?")[0],location.href=i.getRedirectUrl(r+"?"+e.getQueryString())}})})}function c(){require(["page/search/mark-favorite"],function(e){return e.init(".search-list-wrapper")})}function s(){require(["log-search"],function(e){e.register({eventName:"list_search_car_list",container:".search-list-wrapper",eventProperty:function(e){var t=void 0,i=e.parents("[data-search-args]"),r=e.parents("[data-search-id]").attr("data-search-id"),n=parseInt(e.parents("[data-is-near]").attr("data-is-near"),10);return t=n?JSON.parse(i.attr("data-near-args")):JSON.parse(i.attr("data-search-args")),{searchTerm:window.location.href,search_id:r,args:t.args,log_id:t.log_id,query_str:t.query_str,traffic:t.traffic,extra:{type:n?"nearby":""}}}})})}function o(){require(["jquery","jquery.lazyload"],function(e){e(".search-list-wrapper .img-lazy").lazyload({threshold:100,data_attribute:"src"})})}function u(){require(["jquery","store","log"],function(e,t,i){t.get("search_new_visitor")||(e("#city_wrapper").removeClass("city-hide"),e(".city-mask").removeClass("city-hide"),i.push(["_trackEvent","pc_offline_city_show","click","search"]),i.push(["_trackEvent","pc_offline_user_visit","click","search"]),t.set("search_new_visitor","1"))})}function l(){require(["common/bargain"],function(e){e.initCarListBargain()})}function f(){require(["jquery","jquery.cookie"],function(e){function t(t){e.cookie("rrc_login_token")?t(i()):require(["react","react-dom","components/login"],function(e,r,n){var a=document.getElementById("login"),c=r.render(e.createElement(n.Login,{onCallback:function(){t(i())},RRC:RRC}),a);c.setState({phone:"",isLoginShow:!0})})}e(".subscription-btn").on("click",function(){t(n)})})}function d(){require(["jquery"],function(e){var t=e(".bangmai-lite-need-form"),i=t.prevAll().length;4===i&&t.css("margin-left","0")})}function h(){require(["log"],function(e){var t=[];$.each($(".js-search-tag").find(".checkbox-input:checked"),function(){t.push($(this).attr("rrc-event-name"))}),$("#search_list_wrapper").on("click",".car-item",function(){var i=$(this).children("a").data("car-id");$.each(t,function(t,r){var n=r;e.push(["_trackEvent","标签点击车辆","click",{carId:i,tag:n}])})})})}function p(){require(["bangmai-form"],function(e){e.init({event:"pc_bangmai_submit_search_wujieguo",remark:"",target:"#js-search-bangmai",dialog:"#js-success-modal-common",args:RRC.selected,fancySelect:!0})})}function g(){a(),s(),o(),u(),l(),f(),d(),h(),p(),c(),r()}return{init:g,initFilter:a,initLogSearch:s,fixBangmaiLiteStyle:d,initImageLazyload:o,initNewVistorSettings:u,initSubscription:f,getSubscriptionArgs:i,addSubscription:n,initPushTagLog:h,initBangMai:p,initFavorite:c,initAppointment:r}});
//# sourceMappingURL=base-bc62c9a3.js.map
